#:kivy 1.0
# Primary Mirror Control GUI:
<PMC_GUI>:
    cols: 1
    # Top half is for inputs.
    Label:
        id: title_label
        text: "PRIMARY MIRROR CONTROL [Version 0.1]"
        font_size: '20sp'
        bold: True
        size_hint_y: None
        height: 30
        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Line:
                width: 2
                rectangle: self.x, self.y, self.width, self.height
    GridLayout:
        cols: 3
        GridLayout:
            cols: 1
            id: rel_ctrl
            size_hint_x: None
            width: 400
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1 
                Line:
                    width: 2
                    rectangle: self.x, self.y, self.width, self.height
            Label:
                text: "Tip/Tilt/Focus (Relative)"
                size_hint_y: None
                height: 30
            GridLayout:
                cols: 2
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1 
                    Line:
                        width: 2
                        rectangle: self.x, self.y, self.width, self.height
                GridLayout:
                    cols: 1
                    padding: [10, 10, 10, 10]
                    GridLayout:
                        cols: 3
                        #______________
                        Label:
                        Button:
                            id: do_pos_tip_btn
                            text: '+ Tip'
                            size_hint_y: None
                            height: 40
                            size_hint_x: None
                            width: 50
                            disabled: True
                            on_press: root.plusTipButtonPushed()
                        Label:
                        #______________
                        Button:
                            id: do_neg_tilt_btn
                            text: '- Tilt'
                            size_hint_y: None
                            height: 40
                            size_hint_x: None
                            width: 50
                            disabled: True
                            on_press: root.minusTiltButtonPushed()
                        Label: # Would like to put an indicator light here.
                        Button:
                            id: do_pos_tilt_btn
                            text: '+ Tilt'
                            size_hint_y: None
                            height: 40
                            size_hint_x: None
                            width: 50
                            disabled: True
                            on_press: root.plusTiltButtonPushed()
                        #______________
                        Label:
                        Button:
                            id: do_neg_tip_btn
                            text: '- Tip'
                            size_hint_y: None
                            height: 40
                            size_hint_x: None
                            width: 50
                            disabled: True
                            on_press: root.minusTipButtonPushed()
                        Label:
                        #______________
                        Label:
                        Label:
                        Label:
                        #______________
                    Label:
                        text: "Tip/Tilt Step Size [urad]:"
                        size_hint_y:None
                        height: 20
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: 40
                        Button:
                            id: _1urad_btn
                            text: '1'
                            size_hint_y: None
                            height: 30
                            background_color: (0,1,0,1)
                            on_press: root._1uradButtonPushed()
                        Button:
                            id: _10urad_btn
                            text: '10'
                            size_hint_y: None
                            height: 30
                            on_press: root._10uradButtonPushed()
                        Button:
                            id: _100urad_btn
                            text: '100'
                            size_hint_y: None
                            height: 30
                            on_press: root._100uradButtonPushed()
                        Button:
                            id: _1000urad_btn
                            text: '1000'
                            size_hint_y: None
                            height: 30
                            on_press: root._1000uradButtonPushed()
                GridLayout:
                    cols: 1
                    padding: [10, 10, 10, 10]
                    GridLayout:
                        cols: 3
                        Label:
                        Button:
                            id: do_pos_focus_btn
                            text: '+Focus'
                            size_hint_y: None
                            height: 40
                            disabled: True
                            on_press: root.plusFocusButtonPushed()
                        Label:
                        Label:
                        Button:
                            id: do_neg_focus_btn
                            text: '-Focus'
                            size_hint_y: None
                            height: 40
                            disabled: True
                            on_press: root.minusFocusButtonPushed()
                        Label:
                        Label:
                        Label:
                        Label:
                    Label:
                        text: "Focus Step Size [um]:"
                        size_hint_y:None
                        height: 20
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: None
                        height: 40
                        Button:
                            id: _1um_btn
                            text: '1'
                            size_hint_y: None
                            height: 30
                            background_color: (0,1,0,1)
                            on_press: root._1umButtonPushed()
                        Button:
                            id: _10um_btn
                            text: '10'
                            size_hint_y: None
                            height: 30
                            on_press: root._10umButtonPushed()
                        Button:
                            id: _100um_btn
                            text: '100'
                            size_hint_y: None
                            height: 30
                            on_press: root._100umButtonPushed()
                        Button:
                            id: _1000um_btn
                            text: '1000'
                            size_hint_y: None
                            height: 30
                            on_press: root._1000umButtonPushed()
                    #_________________
        GridLayout:
            cols: 1
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1 
                Line:
                    width: 2
                    rectangle: self.x, self.y, self.width, self.height
            Label:
                text: 'Tip/Tilt/Focus Absolute'
                size_hint_y: None
                height: 30

            GridLayout:
                cols: 3
                padding: [15, 10, 10, 10]
                id: abs_ctrl
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1
                    Line:
                        width: 2
                        rectangle: self.x, self.y, self.width, self.height
                Label: 
                    text: 'Tip [urad]: '
                    size_hint_y: None
                    height: 30
                    size_hint_x: None
                    width: 90
                FloatInput:
                    id: tip_abs
                    text: '0.0'
                    size_hint_y: None
                    height: 30
                Button:
                    id: go_abs_tip_btn
                    text:'Go'
                    size_hint_y: None
                    height: 30
                    size_hint_x: None
                    width:30
                    disabled: True
                    on_press: root.tipAbsGoButtonPushed()
                Label: 
                    text: 'Tilt [urad]: '
                    size_hint_y: None
                    height: 30
                    size_hint_x: None
                    width: 90
                FloatInput:
                    id: tilt_abs
                    text: '0.0'
                    size_hint_y: None
                    height: 30
                Button:
                    id: go_abs_tilt_btn
                    text:'Go'
                    size_hint_y: None
                    height: 30
                    size_hint_x: None
                    width:30
                    disabled: True
                    on_press: root.tiltAbsGoButtonPushed()
                Label: 
                    text: 'Focus [um]: '
                    size_hint_y: None
                    height: 30
                    size_hint_x: None
                    width: 90
                FloatInput:
                    id: focus_abs
                    text: '0.0'
                    size_hint_y: None
                    height: 30
                Button:
                    id: go_abs_focus_btn
                    text:'Go'
                    size_hint_y: None
                    height: 30
                    size_hint_x: None
                    width:30
                    disabled: True
                    on_press: root.focusAbsGoButtonPushed()
            GridLayout:
                cols:1
                Label:
                    text: 'Other Controls'
                    size_hint_y : None
                    height:30
                StackLayout:
                    padding: [15, 10, 10, 10]
                    Button:
                        id: connect_btn
                        text:'Connect'
                        size_hint_y: None
                        height: 30
                        size_hint_x: None
                        width:90
                        background_color: (1,0,0,1)
                        on_press: root.connectButtonPushed()
                    Button:
                        id: do_home_all_btn
                        text:'Home All'
                        size_hint_y: None
                        height: 30
                        size_hint_x: None
                        width:70
                        disabled: True
                        on_press: root.homingButtonPushed()
                    Button:
                        text:'Edit Config'
                        size_hint_y: None
                        height: 30
                        size_hint_x: None
                        width:80
                        disabled: True
                        # on_press: root.homingButtonPushed()
        GridLayout:
            cols: 1
            id: outputs
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                Line:
                    width: 2
                    rectangle: self.x, self.y, self.width, self.height
            Label:
                text: "Output (Read-Only)"
                size_hint_y: None
                height: 30
            GridLayout:
                cols: 1
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1 
                    Line:
                        width: 2
                        rectangle: self.x, self.y, self.width, self.height
                GridLayout:
                    cols: 2
                    row_force_default: True
                    row_default_height: 30
                    padding: [10, 10, 10, 10]
                    Label:
                        text: "Tip [urad]: "
                        size_hint_x: None
                        width: 90
                    FloatInput:
                        id: tip_val
                        multiline: 'false'
                        readonly: True
                        text: '0.0'
                    Label:
                        text: "Tilt [urad]: "
                        size_hint_x: None
                        width: 90
                    FloatInput:
                        id: tilt_val
                        multiline: 'false'
                        readonly: True
                        text: '0.0'
                    Label:
                        text: "Focus [um]: "
                        size_hint_x: None
                        width: 90
                    FloatInput:
                        id: focus_val
                        multiline: 'false'
                        readonly: True
                        text: '0.0'
                Label:
            
    TerminalWidget:
        id: app_term
        label: 'Terminal'
            # size_hint :1,1
            # TextInput:
            #     id: app_term
                # disabled: True

<TerminalWidget>:
    cols: 1
    padding: [5, 5, 5, 5]
    term_id: terminal
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Line:
            width: 2
            rectangle: self.x, self.y, self.width, self.height
    Label:
        text: root.label
        size_hint_y: None
        height: 20
    ScrollView:
        id: scrlv
        TextInput:
            id: terminal
            multiline: True
            size_hint: 1,None
            height: max( (len(self._lines)+1) * self.line_height, scrlv.height)
            readonly: True
            text: root.text
            background_color: ( 1, 1, 1, 1)
            # foreground_color: (0,0,0,1)
